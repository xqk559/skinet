!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@angular/router"),require("rxjs"),require("rxjs/operators"),require("@angular/common")):"function"==typeof define&&define.amd?define("xng-breadcrumb",["exports","@angular/core","@angular/router","rxjs","rxjs/operators","@angular/common"],r):r((e=e||self)["xng-breadcrumb"]={},e.ng.core,e.ng.router,e.rxjs,e.rxjs.operators,e.ng.common)}(this,(function(e,r,t,n,a,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var o=function(){return(o=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var a in r=arguments[t])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e}).apply(this,arguments)};function s(e,r,t,n){var a,i=arguments.length,o=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(r,t,o):a(r,t))||o);return i>3&&o&&Object.defineProperty(r,t,o),o}function u(e,r){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function c(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,a,i=t.call(e),o=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return o}var d=function(){function e(){}return e=s([r.Directive({selector:"[xngBreadcrumbItem]"}),u("design:paramtypes",[])],e)}(),l=function(){function e(e,r){this.activatedRoute=e,this.router=r,this.baseHref="/",this.dynamicBreadcrumbStore=[],this.currentBreadcrumbs=[],this.previousBreadcrumbs=[],this.breadcrumbs=new n.BehaviorSubject([]),this.breadcrumbs$=this.breadcrumbs.asObservable(),this.pathParamPrefix=":",this.pathParamRegexIdentifier="/:[^/]+",this.pathParamRegexReplacer="/[^/]+",this.setBaseBreadcrumb(),this.detectRouteChanges()}return e.prototype.set=function(e,r){if(this.validateArguments(e,r))if("string"==typeof r&&(r={label:r}),e.startsWith("@"))this.updateStore(o(o({},r),{alias:e.slice(1)}));else{var t=this.buildRouteRegExp(e);this.updateStore(o(o({},r),t))}},e.prototype.setBaseBreadcrumb=function(){var e=this.router.config.find((function(e){return""===e.path}));if(e&&e.data){var r=this.getBreadcrumbOptions(e.data),t=r.label,n=r.alias,a=r.skip,i=void 0!==a&&a,o=r.info,s=r.disable,u=void 0!==s&&s,c=!1;"string"==typeof t||t||(t="",c=!0),this.baseBreadcrumb={label:t,alias:n,skip:i,disable:u,info:o,routeLink:this.baseHref,isAutoGeneratedLabel:c}}},e.prototype.detectRouteChanges=function(){var e=this;this.router.events.pipe(a.filter((function(e){return e instanceof t.NavigationEnd})),a.distinctUntilChanged()).subscribe((function(r){e.previousBreadcrumbs=e.currentBreadcrumbs,e.currentBreadcrumbs=e.baseBreadcrumb?[e.baseBreadcrumb]:[],e.prepareBreadcrumbList(e.activatedRoute.root,e.baseHref)}))},e.prototype.prepareBreadcrumbList=function(e,r){if(e.routeConfig&&e.routeConfig.path){var t=this.prepareBreadcrumbItem(e,r);if(this.currentBreadcrumbs.push(t),e.firstChild)return this.prepareBreadcrumbList(e.firstChild,t.routeLink+"/")}else if(e.firstChild)return this.prepareBreadcrumbList(e.firstChild,r);var n=this.currentBreadcrumbs[this.currentBreadcrumbs.length-1];this.resolveQueryParamForLastItem(n,e);var a=this.currentBreadcrumbs.filter((function(e){return!e.skip}));this.breadcrumbs.next(a)},e.prototype.prepareBreadcrumbItem=function(e,r){var t=this.parseRouteData(e.routeConfig),n=t.path,a=t.breadcrumb,i=this.resolvePathParam(n,e),s=""+r+i,u=this.getFromStore(a.alias,s),c=u.label,d=u.alias,l=u.skip,p=u.disable,b=u.info,m=!1;return"string"!=typeof c&&("string"==typeof a.label?c=a.label:(c=i,m=!0)),o({label:c,alias:d||a.alias,skip:l||a.skip,disable:p||a.disable,info:b||a.info,routeLink:s,isAutoGeneratedLabel:m},this.resolveQueryParam(s))},e.prototype.parseRouteData=function(e){var r=e.path,t=e.data,n=void 0===t?{}:t;return{path:r,breadcrumb:this.mergeWithBaseChildData(e,o({},n))}},e.prototype.getFromStore=function(e,r){var t;return e&&(t=this.dynamicBreadcrumbStore.find((function(r){return r.alias===e}))),!t&&r&&(t=this.dynamicBreadcrumbStore.find((function(e){return e.routeLink&&e.routeLink===r||e.routeRegex&&new RegExp(e.routeRegex).test(r+"/")}))),t||{}},e.prototype.buildRouteRegExp=function(e){return e.startsWith("/")||(e="/"+e),e.includes(this.pathParamPrefix)?{routeRegex:e.replace(new RegExp(this.pathParamRegexIdentifier,"g"),this.pathParamRegexReplacer)}:{routeLink:e}},e.prototype.updateStore=function(e){var r=this.getBreadcrumbIndexes(e),t=r.breadcrumbItemIndex,n=r.storeItemIndex;if(t>-1){this.currentBreadcrumbs[t]=o(o({},this.currentBreadcrumbs[t]),e);var a=this.currentBreadcrumbs.filter((function(e){return!e.skip}));this.breadcrumbs.next(function(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(c(arguments[r]));return e}(a))}n>-1?this.dynamicBreadcrumbStore[n]=o(o({},this.dynamicBreadcrumbStore[n]),e):this.dynamicBreadcrumbStore.push(e)},e.prototype.getBreadcrumbIndexes=function(e){var r=e.alias,t=e.routeLink,n=e.routeRegex,a={};return r?a=this.getBreadcrumbIndexesByType("alias",r):t?a=this.getBreadcrumbIndexesByType("routeLink",t):n&&(a=this.getBreadcrumbIndexesByType("routeRegex",n)),a},e.prototype.getBreadcrumbIndexesByType=function(e,r){return{breadcrumbItemIndex:"routeRegex"!==e?this.currentBreadcrumbs.findIndex((function(t){return r===t[e]})):this.currentBreadcrumbs.findIndex((function(e){return new RegExp(r).test(e.routeLink)})),storeItemIndex:this.dynamicBreadcrumbStore.findIndex((function(t){return r===t[e]}))}},e.prototype.resolvePathParam=function(e,r){return e.includes(this.pathParamPrefix)&&Object.entries(r.snapshot.params).forEach((function(r){var t=c(r,2),n=t[0],a=t[1];e=e.replace(":"+n,""+a)})),e},e.prototype.resolveQueryParam=function(e){var r=this.previousBreadcrumbs.find((function(r){return r.routeLink===e}))||{};return{queryParams:r.queryParams,fragment:r.fragment}},e.prototype.resolveQueryParamForLastItem=function(e,r){var t=r.snapshot,n=t.queryParams,a=t.fragment;e&&(e.queryParams=Object.keys(n).length>0?o({},n):void 0,e.fragment=a)},e.prototype.mergeWithBaseChildData=function(e,r){return e?(e.loadChildren?t=e._loadedConfig.routes.find((function(e){return""===e.path})):e.children&&(t=e.children.find((function(e){return""===e.path}))),t&&t.data?this.mergeWithBaseChildData(t,o(o({},this.getBreadcrumbOptions(r)),this.getBreadcrumbOptions(t.data))):this.getBreadcrumbOptions(r)):this.getBreadcrumbOptions(r);var t},e.prototype.validateArguments=function(e,r){return null==e?(console.error("Invalid first argument. Please pass a route path or a breadcrumb alias."),!1):null!=r||(console.error("Invalid second argument. Please pass a string or an Object with breadcrumb options."),!1)},e.prototype.getBreadcrumbOptions=function(e){var r=e.breadcrumb;return"string"!=typeof r&&r||(r={label:r}),r},e.ctorParameters=function(){return[{type:t.ActivatedRoute},{type:t.Router}]},e.ɵprov=r.ɵɵdefineInjectable({factory:function(){return new e(r.ɵɵinject(t.ActivatedRoute),r.ɵɵinject(t.Router))},token:e,providedIn:"root"}),e=s([r.Injectable({providedIn:"root"}),u("design:paramtypes",[t.ActivatedRoute,t.Router])],e)}(),p=function(){function e(e){this.breadcrumbService=e,this._separator="/",this.autoGenerate=!0,this.preserveQueryParams=!0,this.class=""}return Object.defineProperty(e.prototype,"separator",{get:function(){return this._separator},set:function(e){e instanceof r.TemplateRef?(this.separatorTemplate=e,this._separator=void 0):(this.separatorTemplate=void 0,this._separator=e||"/")},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var e=this;this.subscription=this.breadcrumbService.breadcrumbs$.subscribe((function(r){e.breadcrumbs=r.map((function(r){return e.preserveQueryParams||(r.routeLink=r.routeLink.split("?")[0]),r})).filter((function(r){return!!e.autoGenerate||!r.isAutoGeneratedLabel}))}))},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.ctorParameters=function(){return[{type:l}]},s([r.ContentChild(d,{static:!1,read:r.TemplateRef}),u("design:type",Object)],e.prototype,"itemTemplate",void 0),s([r.Input(),u("design:type",Object)],e.prototype,"autoGenerate",void 0),s([r.Input(),u("design:type",Object)],e.prototype,"preserveQueryParams",void 0),s([r.Input(),u("design:type",Object)],e.prototype,"class",void 0),s([r.Input("separator"),u("design:type",Object),u("design:paramtypes",[Object])],e.prototype,"separator",null),e=s([r.Component({selector:"xng-breadcrumb",template:'<nav aria-label="breadcrumb" class="xng-breadcrumb-root" [ngClass]="class">\n  <ol class="xng-breadcrumb-list">\n    <ng-container *ngFor="let breadcrumb of breadcrumbs; last as isLast; first as isFirst">\n      <li class="xng-breadcrumb-item">\n        <a\n          *ngIf="!isLast"\n          [routerLink]="[breadcrumb.routeLink]"\n          class="xng-breadcrumb-link"\n          [ngClass]="{ \'xng-breadcrumb-link-disabled\': breadcrumb.disable }"\n          [attr.aria-disabled]="breadcrumb.disable"\n          [queryParams]="breadcrumb.queryParams"\n          [fragment]="breadcrumb.fragment"\n        >\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: breadcrumb.label, info: breadcrumb.info, last: isLast, first: isFirst }"\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{ breadcrumb.label }}</ng-container>\n        </a>\n\n        <label *ngIf="isLast" class="xng-breadcrumb-trail">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: breadcrumb.label, info: breadcrumb.info, last: isLast, first: isFirst }"\n          ></ng-container>\n          <ng-container *ngIf="!itemTemplate">{{ breadcrumb.label }}</ng-container>\n        </label>\n      </li>\n\n      <li *ngIf="!isLast" class="xng-breadcrumb-separator" aria-hidden="true" role="separator">\n        <ng-container *ngTemplateOutlet="separatorTemplate"></ng-container>\n        <ng-container *ngIf="!separatorTemplate">{{ separator }}</ng-container>\n      </li>\n    </ng-container>\n  </ol>\n</nav>\n',encapsulation:r.ViewEncapsulation.None,styles:[".xng-breadcrumb-root{margin:0;color:rgba(0,0,0,.6)}.xng-breadcrumb-list{display:flex;align-items:center;flex-wrap:wrap;margin:0;padding:0}.xng-breadcrumb-item{list-style:none}.xng-breadcrumb-trail{display:flex;align-items:center;color:rgba(0,0,0,.9)}.xng-breadcrumb-link{display:flex;align-items:center;white-space:nowrap;color:inherit;text-decoration:none;transition:text-decoration .3s;transition:text-decoration .3s,-webkit-text-decoration .3s}.xng-breadcrumb-link:hover{text-decoration:underline}.xng-breadcrumb-link-disabled{pointer-events:none;cursor:disabled}.xng-breadcrumb-separator{display:flex;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;margin-left:8px;margin-right:8px}"]}),u("design:paramtypes",[l])],e)}(),b=function(){function e(){}return e=s([r.NgModule({declarations:[p,d],imports:[i.CommonModule,t.RouterModule],exports:[p,d]})],e)}();e.BreadcrumbComponent=p,e.BreadcrumbItemDirective=d,e.BreadcrumbModule=b,e.BreadcrumbService=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=xng-breadcrumb.umd.min.js.map